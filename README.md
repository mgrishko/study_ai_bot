# Aiogram 3.0 –ß–∞—Ç-–±–æ—Ç - –ú–∞–≥–∞–∑–∏–Ω –≤–µ—Ä—Ö–Ω—å–æ–≥–æ –æ–¥—è–≥—É

–ß–∞—Ç-–±–æ—Ç –¥–ª—è –º–∞–≥–∞–∑–∏–Ω—É –≤–µ—Ä—Ö–Ω—å–æ–≥–æ –æ–¥—è–≥—É, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –Ω–∞ Python –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Aiogram 3.0 —Ç–∞ PostgreSQL.

## –í–∏–º–æ–≥–∏

- Python 3.13
- PostgreSQL 12+
- Aiogram 3.15.0
- asyncpg 0.30.0
- python-dotenv 1.0.0

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
aiogram_project/
‚îú‚îÄ‚îÄ bot.py                 # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫—É –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ database.py            # –†–æ–±–æ—Ç–∞ –∑ PostgreSQL
‚îú‚îÄ‚îÄ .env                   # –ó–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
‚îú‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ handlers/             # –û–±—Ä–æ–±–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥ —Ç–∞ callbacks
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ common.py        # –ó–∞–≥–∞–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ (/start, /help, /info)
‚îÇ   ‚îú‚îÄ‚îÄ user.py          # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (–∫–∞—Ç–∞–ª–æ–≥, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è)
‚îÇ   ‚îî‚îÄ‚îÄ admin.py         # –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ keyboards/           # –Ü–Ω–ª–∞–π–Ω-–∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∏
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ inline.py        # –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
‚îÇ   ‚îî‚îÄ‚îÄ admin.py         # –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
‚îú‚îÄ‚îÄ filters/             # –§—ñ–ª—å—Ç—Ä–∏ –¥–ª—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ admin.py         # –§—ñ–ª—å—Ç—Ä –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îî‚îÄ‚îÄ utils/               # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
```

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ:
```bash
python3.13 -m venv venv
source venv/bin/activate
```

2. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
```bash
pip install -r requirements.txt
```

3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ PostgreSQL:
```bash
# macOS
brew install postgresql@18
brew services start postgresql@18

# –°—Ç–≤–æ—Ä—ñ—Ç—å –±–∞–∑—É –¥–∞–Ω–∏—Ö —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
/opt/homebrew/opt/postgresql@18/bin/createdb shop_bot
/opt/homebrew/opt/postgresql@18/bin/createuser shop_bot_user

# –ù–∞–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞
/opt/homebrew/opt/postgresql@18/bin/psql -d shop_bot -c "GRANT ALL PRIVILEGES ON SCHEMA public TO shop_bot_user;"
```

4. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –≤ `.env`:
   - `BOT_TOKEN` - —Ç–æ–∫–µ–Ω –≤—ñ–¥ [@BotFather](https://t.me/BotFather)
   - `DB_*` - –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ PostgreSQL
   - `ADMIN_IDS` - ID –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤ —á–µ—Ä–µ–∑ –∫–æ–º—É (–¥—ñ–∑–Ω–∞–π—Ç–µ—Å—è —Å–≤—ñ–π ID —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot))

## –ó–∞–ø—É—Å–∫

```bash
python bot.py
```

## –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### –ú–µ–Ω—é (Reply Keyboard - –∫–Ω–æ–ø–∫–∏ –≤–Ω–∏–∑—É —á–∞—Ç–∞)

–ü–æ—Å–ª–µ /start –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–¥–æ–±–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏:

**–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
```
üõçÔ∏è –ö–∞—Ç–∞–ª–æ–≥    | üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
üìö –ö–∞—Ç–µ–≥–æ—Ä–∏–∏   | ‚ùì –ü–æ–º–æ—â—å
‚ÑπÔ∏è –û –º–∞–≥–∞–∑–∏–Ω–µ   | üé® AI
```

**–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
```
üõçÔ∏è –ö–∞—Ç–∞–ª–æ–≥      | üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä | ‚ùì –ü–æ–º–æ—â—å
üé® AI
```

–ö–∞–∂–¥–∞—è –∫–Ω–æ–ø–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º.

### –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
- `/start` - –ü–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—Ç–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é)
- `/help` - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `/info` - –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –±–æ—Ç
- `/catalog` - –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤ –∑ —ñ–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∞–º–∏
- `/order` - –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- `/categories` - –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–æ–≤–∞—Ä—ñ–≤
- `/myorders` - –ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- `/generate` - AI –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:
- `/admin` - –ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, –¥–æ—Ö—ñ–¥)
- **–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è** - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º–∏ (–ø–µ—Ä–µ–≥–ª—è–¥, –∑–º—ñ–Ω–∞ —Å—Ç–∞—Ç—É—Å—É)
- **–¢–æ–≤–∞—Ä–∏** - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–æ–≤–∞—Ä–∞–º–∏ (–¥–æ–¥–∞–≤–∞–Ω–Ω—è, —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è, –≤–∏–¥–∞–ª–µ–Ω–Ω—è)
- **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ** - –ü–µ—Ä–µ–≥–ª—è–¥ —Å–ø–∏—Å–∫—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

## –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö PostgreSQL

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—å:
- **products** - —Ç–æ–≤–∞—Ä–∏ (–Ω–∞–∑–≤–∞, –æ–ø–∏—Å, —Ü—ñ–Ω–∞, –∫–∞—Ç–µ–≥–æ—Ä—ñ—è, –∑–∞–ª–∏—à–æ–∫)
- **orders** - –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑—ñ —Å—Ç–∞—Ç—É—Å–∞–º–∏ (pending, confirmed, shipped, delivered, cancelled)
- **users** - –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –±–æ—Ç–∞

–ü—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—é—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü—ñ —Ç–∞ –¥–æ–¥–∞—é—Ç—å—Å—è –ø–æ—á–∞—Ç–∫–æ–≤—ñ —Ç–æ–≤–∞—Ä–∏.

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É `logging` —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –≤ —Å—Ç–∏–ª–µ Rails:

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **logs/bot.log** - –≤—Å–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å —Ä–æ—Ç–∞—Ü–∏–µ–π 10MB, 5 –±—ç–∫–∞–ø–æ–≤)
- **logs/errors.log** - —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

```
2025-12-11 13:30:07 [aiogram.database] INFO: Product added: Test Product (ID: 41)
2025-12-11 13:30:13 [aiogram.requests] INFO: [REQUEST] command:/start user_id=207126754
2025-12-11 13:30:13 [aiogram.requests] INFO: [RESPONSE] command:/start user_id=207126754 completed in 0.045s
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ –º–æ–¥—É–ª—è–º

- **aiogram.requests** - –∑–∞–ø—Ä–æ—Å—ã –∏ responses (INFO)
- **aiogram.database** - –æ–ø–µ—Ä–∞—Ü–∏–∏ –ë–î (INFO)
- **aiogram.handlers** - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (INFO)
- **openai.service** - OpenAI –æ–ø–µ—Ä–∞—Ü–∏–∏ (INFO)
- **asyncpg** - library (WARNING)

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ

```python
from logger_config import get_logger

logger = get_logger("aiogram.handlers")

logger.info("–ö–æ–º–∞–Ω–¥–∞ /start –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
logger.warning("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞")
logger.error("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞", exc_info=True)
```

## –†–æ–∑—Ä–æ–±–∫–∞

–ü—Ä–æ–µ–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–æ–¥—É–ª—å–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –∑ —Ä–æ—É—Ç–µ—Ä–∞–º–∏ –¥–ª—è –∫—Ä–∞—â–æ—ó –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –∫–æ–¥—É:
- **–†–æ—É—Ç–µ—Ä–∏** - –æ–∫—Ä–µ–º—ñ –º–æ–¥—É–ª—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π
- **–§—ñ–ª—å—Ç—Ä–∏** - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É
- **–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∏** - –≤–∏–Ω–µ—Å–µ–Ω—ñ –≤ –æ–∫—Ä–µ–º—ñ –º–æ–¥—É–ª—ñ
- **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è** - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
